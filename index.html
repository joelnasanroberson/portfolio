<!-- /index.html (Bauhaus variant, theme‑reactive background)
SNAP-TO-STRICT BAUHAUS PLAN (pseudocode):
1) Keep shape vars `--shape-1..4` + `--shape-ring`.
2) Replace palette builder with a snap-to-primaries (Red/Blue/Yellow) algorithm.
3) Only adjust lightness (shades), never hue; ensure contrast vs `--page-bg`.
4) Reuse hardening (guards/IO/GSAP/rAF) and self-tests.
-->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="color-scheme" content="dark light">
  <meta name="description" content="Portfolio of Joel N. Roberson — Marketing & Growth Strategist. SEO/SEM, paid media, partnerships, events, and creative production.">
  <title>Joel N. Roberson – Marketing & Growth Strategist</title>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <link href="https://db.onlinewebfonts.com/c/f2b7f17d01f1f14802062ce0574b4d4a?family=Futura+PT" rel="stylesheet">

  <style>
    /* ------------------------------
       THEME TOKENS (Bauhaus: bold, flat, geometric + organic)
    ------------------------------ */
    :root{
      /* Core palette */
      --bau-black:#0e0e0e;
      --bau-ink:#111111;
      --bau-cream:#F4F1E8;
      --bau-red:#E94F37;
      --bau-blue:#1C7ED6;
      --bau-blue-light:#4da3f0; /* lighter blue */
      --bau-yellow:#F6C90E;

      /* Typography */
      --header:'Futura PT', sans-serif;
      --sans:'Inter', system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;

      /* UI tokens */
      --text:#f7f7f7;
      --text-muted: rgba(247,247,247,.82);
      --accent: var(--bau-blue);
      --accent-2: #155ab4;
      --ring: 0 0 0 3px rgba(28,126,214,.35);

      /* Theme‑reactive background token */
      --page-bg: var(--bau-black);

      /* Overlay token (tuned in JS for contrast) */
      --overlay-bg: rgba(0,0,0,.45);

      /* NEW: reactive shape colors (auto-set in JS; these are safe defaults) */
      --shape-1: var(--bau-blue);
      --shape-2: var(--bau-yellow);
      --shape-3: var(--bau-red);
      --shape-4: var(--bau-blue);
      --shape-ring: var(--bau-blue-light);

      --radius:14px;
      --shadow-1: 0 0 0 rgba(0,0,0,0); /* flat */
      --shadow-2: 0 0 0 rgba(0,0,0,0); /* flat */
    }

    /* ------------------------------
       RESET / BASE
    ------------------------------ */
    *{box-sizing:border-box}
    html{scroll-behavior:smooth;text-size-adjust:100%}
    body{
      margin:0; color:var(--text); font-family:var(--sans);
      -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
      overflow-x:hidden; text-align:center; min-height:100%;
      background: var(--page-bg);
      transition: background .35s ease, color .2s ease;
    }
    img{max-width:100%;display:block}
    a{color:inherit}
    :focus-visible{outline:none; box-shadow: var(--ring); border-radius:10px}

    /* Dev banner (hidden by default) */
    #bug-banner{position:fixed;left:12px;bottom:12px;z-index:11000;background:#ffefef;color:#8a1f1f;border:2px solid #8a1f1f;border-radius:10px;padding:.5rem .75rem;font:600 12px/1.2 var(--sans);display:none}
    #bug-banner[data-show="true"]{display:block}

    /* Bauhaus backdrop: bold flat shapes (pure CSS, no images) */
    .bauhaus{ position:fixed; inset:0; z-index:-2; pointer-events:none; }
    .shape{ position:absolute; pointer-events:none; }
    .shape.circle{ border-radius:50%; }
    .shape.ring{ border-radius:50%; background:transparent; }
    .shape.blob{ border-radius: 42% 58% 50% 50% / 55% 40% 60% 45%; }
    .shape.semi{ border-radius:50%; clip-path: inset(50% 0 0 0); }

    /* Layout */
    header{ position:sticky; top:0; z-index:100; padding:.75rem 1rem; background:linear-gradient(180deg,rgba(0,0,0,.42),transparent); backdrop-filter:saturate(120%) blur(2px); }
    header .header-inner{ width:min(1120px,92vw); margin-inline:auto; display:grid; grid-template-columns: 1fr auto 1fr; align-items:center; justify-items:center; gap:1rem; }
    .site-logo{ grid-column:2; width:44px; height:44px; border-radius:9999px; display:grid; place-items:center; text-decoration:none; color:var(--text); }
.site-logo img,.site-logo svg{ display:block; width:44px; height:44px; object-fit:contain; }
.site-nav{ grid-column:3; justify-self:end; }

    .container{ width:min(1120px,92vw); margin-inline:auto; display:flex; flex-direction:column; align-items:center; justify-content:center; text-align:center }

    /* Section text overlay */
    section[data-overlay] .container{ position:relative; isolation:isolate; }
    section[data-overlay] .container::before{
      content:""; position:absolute; inset:-1.25rem;
      background: var(--overlay-bg);
      border-radius: var(--radius);
      opacity:0; transition: opacity .35s ease; z-index:-1;
    }
    section[data-overlay][data-active="true"] .container::before{ opacity:.6 }

    /* Compact site nav */
    .site-nav{ display:flex; align-items:center; gap:.25rem; background: var(--bau-cream); padding:.4rem; border-radius:9999px; border:2px solid var(--bau-ink); max-width:92vw; overflow-x:auto; -webkit-overflow-scrolling:touch; opacity:0; visibility:hidden; transform: translateY(-6px); transition: opacity .22s ease, transform .22s ease, visibility 0s linear .22s; }
    body.show-mini-nav .site-nav{ opacity:1; visibility:visible; transform: translateY(0); transition-delay: 0s; }
    .site-nav a{ font-family:var(--header); font-weight:800; letter-spacing:.03em; font-size:.92rem; padding:.5rem .8rem; border-radius:9999px; text-decoration:none; color:var(--bau-ink); white-space:nowrap; transition: background .2s ease, color .2s ease; }
    .site-nav a:hover{ background: var(--bau-ink); color:#fff }
    .site-nav a[aria-current="page"]{ background: var(--accent); color:#fff; border:2px solid var(--bau-ink); }

    main{isolation:isolate}
    section{ min-height:100vh; display:flex; align-items:center; justify-content:center; flex-direction:column; padding:6rem 2rem; text-align:center }

    h1,h2,h3{font-family:var(--header); margin:0}
    h1 {font-size:clamp(2.8rem,6vw,4.6rem); color:var(--bau-blue-light);letter-spacing:-.5px;}    
    h2{font-size:clamp(1.25rem,2.5vw,2rem); margin-top:1rem; color:var(--text)}
    h3.tagline{font-size:clamp(1.05rem,2.1vw,1.5rem); margin-top:.75rem; font-weight:800; letter-spacing:.02em; color:var(--text-muted)}
    p{max-width:70ch; margin:1rem auto 0; color:var(--text-muted); line-height:1.7}

    .skills-grid,.projects-grid{ display:grid; grid-template-columns:repeat(auto-fit,minmax(260px,1fr)); gap:1.5rem; max-width:1200px; margin:2rem auto; justify-items:center }

    /* Flat cards (cream w/ ink border) */
    .card{ background:var(--bau-cream); color:var(--bau-ink); padding:1.6rem; border-radius:10px; border:2px solid var(--bau-ink); box-shadow:none; max-width:320px; text-align:left }
    .card h3{ margin:0 0 .5rem 0; color:var(--bau-ink) }
    .card p{ color:#222; margin:0 }

    /* Poster-like case blocks (primary colors) */
    .projects-grid .case{ border:none; border-radius:12px; font-weight:900; letter-spacing:.02em; box-shadow:none; transition: transform .2s ease; }
    .projects-grid .case:hover{ transform: translateY(-2px) }
    .projects-grid .case:nth-child(1){ background:var(--bau-red); color:#fff }
    .projects-grid .case:nth-child(2){ background:var(--bau-blue); color:#fff }
    .projects-grid .case:nth-child(3){ background:var(--bau-yellow); color:#111 }
    .projects-grid .case:nth-child(4){ background:var(--bau-cream); color:#111; border:2px solid var(--bau-ink) }

    .contact a{ display:inline-block; margin-top:1.25rem; padding:.75rem 1.25rem; background:var(--accent); color:#fff; text-decoration:none; border-radius:10px; border:2px solid var(--bau-ink); }
    .contact a:hover{ filter: brightness(.95) }

    /* custom cursor (kept) */
    .cursor{ width:18px; height:18px; border:2px solid var(--accent); border-radius:50%; position:fixed; left:0; top:0; transform:translate(-50%,-50%); pointer-events:none; z-index:10999; transition:width .18s ease, height .18s ease, background .18s ease, transform .08s ease }
    .cursor.active{width:44px; height:44px; background:rgba(28,126,214,.16)}

    /* ------------------------------
       RADIAL MENU (welcome screen only)
       Flat ring + center-based layout
    ------------------------------ */
    #radial-menu-wrap{ position:fixed; inset:0; z-index:10990; display:grid; place-items:center; pointer-events:none; opacity:1; transform: scale(1); transition: opacity .28s ease, transform .28s ease; }
    #radial-menu-wrap[data-visible="false"]{ opacity:0; transform: scale(.96); pointer-events:none }

    .radial-menu{ position:relative; width:520px; height:520px; pointer-events:none; }
    .radial-menu *{ pointer-events:auto; }

    .rm-circle{ position:absolute; inset:0; margin:auto; border-radius:999px; box-shadow:none; --rm-thickness: 6px; transition: transform .25s ease; }
    .rm-circle::before{ content:""; position:absolute; inset:0; border-radius:inherit;
      background: conic-gradient(var(--bau-blue-light) 0 120deg, var(--bau-red) 120deg 240deg, var(--bau-yellow) 240deg 360deg);
      -webkit-mask: radial-gradient(farthest-side, transparent calc(100% - var(--rm-thickness)), #000 calc(100% - var(--rm-thickness)));
      mask: radial-gradient(farthest-side, transparent calc(100% - var(--rm-thickness)), #000 calc(100% - var(--rm-thickness)));
      animation: ringSpin 20s linear infinite;
    }
    @keyframes ringSpin{ to{ transform: rotate(360deg) } }

    .rm-link{ position:absolute; top:50%; left:50%; transform-origin:50% 50%; color:var(--text); text-decoration:none; font-family:var(--header); font-weight:900; letter-spacing:.04em; transition: color .2s ease, opacity .2s ease, filter .2s ease, transform .18s ease; outline:none; white-space:nowrap; text-transform:uppercase; }
    .rm-hover{ position:absolute; top:50%; left:50%; opacity:0; height:2.1rem; border-right:6px solid var(--accent); transition: opacity .2s ease, border-color .2s ease, transform .18s ease; transform-origin:0 50%; }

    .rm-link[aria-current="page"]{ color:var(--text); }
    .rm-link[aria-current="page"] + .rm-hover{ opacity:1; border-right-color:var(--accent); }

    .shrink .radial-menu{ transform: scale(.9); transition: transform .25s ease }

    .radial-fab{ position:fixed; bottom:18px; right:18px; width:56px; height:56px; border-radius:999px; border:2px solid var(--bau-ink); background:var(--bau-cream); color:var(--bau-ink); font-weight:700; display:none; align-items:center; justify-content:center; cursor:pointer; box-shadow:none; }
    .radial-fab:hover{ filter: brightness(.95) }
    .radial-fab:focus-visible{ box-shadow: var(--ring) }

    .radial-menu[data-collapsed="true"] .rm-circle,
    .radial-menu[data-collapsed="true"] .rm-link,
    .radial-menu[data-collapsed="true"] .rm-hover{ opacity:0; pointer-events:none }

    @media (max-width: 900px){ .radial-menu{ width:420px; height:420px } }
    @media (max-width: 820px){ .radial-menu{ width:360px; height:360px } .radial-fab{ display:flex } }

    /* ------------------------------
       Motion: shapes (CSS + SVG filter)
    ------------------------------ */
    @keyframes blobMorph{
      0%   { border-radius:42% 58% 50% 50% / 55% 40% 60% 45%; }
      50%  { border-radius:58% 42% 47% 53% / 45% 60% 40% 55%; }
      100% { border-radius:42% 58% 50% 50% / 55% 40% 60% 45%; }
    }
    @keyframes floatY{
      0%,100% { transform: translateY(0) }
      50%     { transform: translateY(-10px) }
    }
    .shape.blob{ animation: blobMorph 16s ease-in-out infinite; filter: url(#liquid); will-change: transform, border-radius; }
    .shape.circle{ animation: floatY 12s ease-in-out infinite; filter: url(#liquid-soft); will-change: transform; }

    /* Reduced motion */
    @media (prefers-reduced-motion: reduce){
      *{scroll-behavior:auto !important}
      .cursor{transition:none !important}
      .shape.blob,.shape.circle{ animation:none !important; filter:none !important }
      .rm-circle::before{ animation: none !important }
    
  </style>
</head>
<body>
  <!-- Bauhaus background composition -->
  <div class="bauhaus" aria-hidden="true">
    <!-- reactive colors (no hard-coded bau-* tokens here) -->
    <span class="shape circle" style="width:360px;height:360px;left:-120px;top:-140px;background:var(--shape-1);"></span>
    <span class="shape semi" style="width:300px;height:300px;left:-80px;bottom:-120px;background:var(--shape-2);transform:rotate(90deg);"></span>
    <span class="shape blob" style="width:460px;height:360px;right:-140px;top:18vh;background:var(--shape-3);"></span>
    <span class="shape ring" style="width:520px;height:520px;left:50%;top:48vh;transform:translate(-50%,-50%);border:18px solid var(--shape-ring);"></span>
    <span class="shape" style="width:220px;height:28px;right:6vw;bottom:8vh;background:var(--shape-4);"></span>
  </div>

  <!-- SVG filter defs for organic motion -->
  <svg aria-hidden="true" focusable="false" width="0" height="0" style="position:absolute">
    <defs>
      <filter id="liquid">
        <feTurbulence type="fractalNoise" baseFrequency="0.006" numOctaves="2" seed="7">
          <animate attributeName="baseFrequency" dur="14s" values="0.006;0.009;0.006" repeatCount="indefinite" />
        </feTurbulence>
        <feDisplacementMap in="SourceGraphic" scale="18" xChannelSelector="R" yChannelSelector="G"/>
      </filter>
      <filter id="liquid-soft">
        <feTurbulence type="fractalNoise" baseFrequency="0.004" numOctaves="2" seed="3">
          <animate attributeName="baseFrequency" dur="16s" values="0.004;0.006;0.004" repeatCount="indefinite" />
        </feTurbulence>
        <feDisplacementMap in="SourceGraphic" scale="6" xChannelSelector="R" yChannelSelector="G"/>
      </filter>
    </defs>
  </svg>

  <header role="banner">
    <div class="header-inner">
      <div class="header-left" aria-hidden="true"></div>
      <a href="#home" class="site-logo" aria-label="Home">
        <img src="https://github.com/joelnasanroberson/portfolio/blob/main/jr%20portfolio%20logo1.png?raw=true" alt="Joel Roberson logo" width="44" height="44" decoding="async"/>
      </a>
      <nav id="site-nav" class="site-nav" aria-label="Section navigation"></nav>
    </div>
  </header>

  <div class="cursor" id="custom-cursor" aria-hidden="true"></div>

  <main id="main">
    <section class="hero" id="home" aria-label="Introduction" data-color="#1C7ED6">
      <div class="container">
        <!-- hero title removed per request -->
      </div>
    </section>

    <section id="about" aria-labelledby="about-h" data-color="#E94F37" data-overlay>
      <div class="container">
        <h2 id="about-h">About</h2>
        <h3 class="tagline">Marketing &amp; Growth Strategist — Bridging creativity with analytics</h3>
        <p>Skilled in SEO, Google Ads, partnerships, event marketing, and digital media production. Proven success modernizing marketing systems for small and mid-size businesses, growing revenue, and amplifying creative brands.</p>
        <p>I'm Joel — a marketing &amp; growth strategist who balances creative production with data-driven systems to deliver measurable results across search, paid media, partnerships, and live events. B.S. IT Management, FSCJ (2018–2022).</p>
      </div>
    </section>

    <section id="skills" aria-labelledby="skills-h" data-color="#F6C90E">
      <div class="container">
        <h2 id="skills-h">Skills</h2>
        <div class="skills-grid">
          <div class="card"><h3>Growth &amp; Digital Strategy</h3><p>SEO/SEM, Google Ads, GA4, funnel optimization, paid media, CRM automation.</p></div>
          <div class="card"><h3>Creative &amp; Brand</h3><p>Adobe Suite, video production, photography, creative direction, web design (Wix/WordPress).</p></div>
          <div class="card"><h3>Leadership &amp; Ops</h3><p>Team leadership (20+), revenue strategy, event &amp; trade show marketing, partnership development.</p></div>
        </div>
      </div>
    </section>

    <section id="experience" aria-labelledby="experience-h" data-color="#1C7ED6">
      <div class="container">
        <h2 id="experience-h">Experience</h2>
        <div class="skills-grid">
          <div class="card"><h3>Marketing Manager — One on One / Next Level</h3><p>Modernized marketing systems into scalable growth engines, generating $2M+ in under 2 years. Built SEO + Google Ads with geo-targeting and GSC insights. Achieved 8.6× ROAS.</p></div>
          <div class="card"><h3>Social Media Specialist — UMove Marketing</h3><p>Managed 15 accounts (~500k followers). Insight-driven strategies produced up to +315% monthly engagement growth. Video production and live event coverage.</p></div>
          <div class="card"><h3>Freelance Digital Content Producer</h3><p>Produced 40+ music videos and content campaigns, contributing to 7M+ streams and working with Grammy-nominated artists. Expert in Premiere &amp; Photoshop.</p></div>
        </div>
      </div>
    </section>

    <section id="cases" aria-labelledby="cases-h" data-color="#E94F37">
      <div class="container">
        <h2 id="cases-h">Case Studies</h2>
        <div class="projects-grid">
          <button class="case" type="button">Brand Awareness</button>
          <button class="case" type="button">Community Growth</button>
          <button class="case" type="button">Conversion Optimization</button>
          <button class="case" type="button">Creative Campaigns</button>
        </div>
      </div>
    </section>

    <section id="contact" aria-labelledby="contact-h" data-color="#F6C90E" data-overlay>
      <div class="container">
        <h2 id="contact-h">Get in touch</h2>
        <p>Email: <a href="mailto:joelnasanroberson@gmail.com">joelnasanroberson@gmail.com</a> · Phone: <a href="tel:+19047131424">(904) 713-1424</a></p>
        <div class="contact"><a href="mailto:joelnasanroberson@gmail.com">Contact Me</a></div>
      </div>
    </section>
  </main>

  <!-- Radial menu centerpiece (welcome screen) -->
  <div id="radial-menu-wrap" role="region" aria-label="Quick actions" data-visible="true">
    <button class="radial-fab" id="radial-fab" aria-controls="radial-menu" aria-expanded="true" title="Toggle quick menu">☰</button>
    <div id="radial-menu" class="radial-menu" data-collapsed="false">
      <div class="rm-circle" aria-hidden="true"></div>
    </div>
  </div>

  <!-- Dev banner (hidden); toggle via setBugBanner() in JS -->
  <div id="bug-banner" aria-live="assertive"></div>

  <!-- GSAP (optional, deferred) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js" defer crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js" defer crossorigin="anonymous" referrerpolicy="no-referrer"></script>

  <script>
    // Simple error surface (dev-friendly)
    function setBugBanner(msg){
      try{ const el = document.getElementById('bug-banner'); if(!el) return; el.textContent = msg; el.dataset.show = 'true'; }catch(_){/*noop*/}
    }

    window.addEventListener('DOMContentLoaded', () => {
      try{
        const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

        /* Utils */
        function setTransform(el, val){ if(!el) return; el.style.transform = val; el.style.webkitTransform = val; }
        function setTransition(el, val){ if(!el) return; el.style.transition = val; el.style.webkitTransition = val; }

        /* Color helpers */
        function hexToRgb(hex){
          let h = String(hex || '').replace('#','');
          if (!h) return {r:0,g:0,b:0};
          if (h.length === 3) h = h.split('').map(x=>x+x).join('');
          const num = parseInt(h,16);
          return { r:(num>>16)&255, g:(num>>8)&255, b:num&255 };
        }
        function rgbToHsl(r,g,b){
          r/=255; g/=255; b/=255;
          const max=Math.max(r,g,b), min=Math.min(r,g,b);
          let h,s,l=(max+min)/2;
          if(max===min){ h=s=0; }
          else {
            const d=max-min; s=l>0.5? d/(2-max-min) : d/(max+min);
            switch(max){
              case r: h=(g-b)/d + (g<b?6:0); break;
              case g: h=(b-r)/d + 2; break;
              case b: h=(r-g)/d + 4; break;
            }
            h*=60;
          }
          return {h, s: s*100, l: l*100};
        }
        function hexToHsl(hex){ const {r,g,b}=hexToRgb(hex); return rgbToHsl(r,g,b); }
        function hslToHex(h,s,l){
          s/=100; l/=100;
          const a = s * Math.min(l,1-l);
          const f = n => {
            const k = (n + h/30) % 12;
            const c = l - a * Math.max(-1, Math.min(k-3, Math.min(9-k,1)));
            return Math.round(255 * c);
          };
          const r=f(0), g=f(8), b=f(4);
          return '#'+[r,g,b].map(x=>x.toString(16).padStart(2,'0')).join('');
        }
        function clamp(v,min,max){ return Math.max(min, Math.min(max, v)); }
        function yiq(hex){ const {r,g,b}=hexToRgb(hex); return (r*299 + g*587 + b*114)/1000; }
        function ensureContrast(bgHex, fgHex, minDelta=65){
          let {h,s,l} = hexToHsl(fgHex);
          const bgY = yiq(bgHex);
          let fgY = yiq(fgHex);
          let tries=0;
          while (Math.abs(fgY - bgY) < minDelta && tries < 8){
            l = fgY > bgY ? clamp(l-8, 20, 88) : clamp(l+8, 20, 88);
            const next = hslToHex(h, clamp(s, 50, 95), l);
            fgY = yiq(next); fgHex = next; tries++;
          }
          return fgHex;
        }
        function rotate(h,deg){ let x = (h+deg)%360; if (x<0) x+=360; return x; }
        function hueDist(a,b){ let d = Math.abs((a||0)-(b||0))%360; return d>180?360-d:d; }
        function ensureContrastShade(bgHex, baseHex, minDelta=65, direction='auto'){
          // keep strict hue; vary lightness; boost saturation to avoid pink/beige
          let {h,s,l} = hexToHsl(baseHex);
          s = clamp(s, 85, 98);           // vivid — prevents beige/pink tints
          l = clamp(l, 34, 66);           // mid-range only
          const bgY = yiq(bgHex);
          let cur = hslToHex(h, s, l), curY = yiq(cur), tries=0;
          while (Math.abs(curY - bgY) < minDelta && tries < 10){
            if (direction==='up') l = clamp(l+6, 34, 70);
            else if (direction==='down') l = clamp(l-6, 28, 66);
            else l = (curY > bgY) ? clamp(l-6, 28, 66) : clamp(l+6, 34, 70);
            cur = hslToHex(h, s, l); curY = yiq(cur); tries++;
          }
          return cur;
        }

        function buildPureBauhausPalette(accent){
          const cssVar = (name, fb) => getComputedStyle(document.documentElement).getPropertyValue(name).trim() || fb;
          const RED = cssVar('--bau-red','#E94F37');
          const BLUE = cssVar('--bau-blue','#1C7ED6');
          const YELLOW = cssVar('--bau-yellow','#F6C90E');
          const BLUE_LT = cssVar('--bau-blue-light','#4da3f0');

          const {h:ha} = hexToHsl(accent);
          const H = { red: hexToHsl(RED).h, blue: hexToHsl(BLUE).h, yellow: hexToHsl(YELLOW).h };
          const deltas = [
            {name:'red',    hex:RED,    d:hueDist(ha,H.red)},
            {name:'blue',   hex:BLUE,   d:hueDist(ha,H.blue)},
            {name:'yellow', hex:YELLOW, d:hueDist(ha,H.yellow)}
          ].sort((a,b)=>a.d-b.d);
          const primary = deltas[0];
          const others = [{name:'red',hex:RED},{name:'blue',hex:BLUE},{name:'yellow',hex:YELLOW}].filter(o=>o.name!==primary.name);

          // Keep pure primaries; avoid using the same as background accent
          const c1 = others[0].hex;
          const c2 = others[1].hex;
          const c3 = others[0].hex;
          const bar = others[1].hex;
          const ring = BLUE_LT; // cool ring tint; gradient ring handled via CSS
          return {c1,c2,c3,bar,ring};
        }

        function yiqIsLight(hex){
          const y = yiq(hex);
          return y > 170; // tuned for readability on yellow
        }
        function applyTheme(color){
          const root = document.documentElement;
          root.style.setProperty('--page-bg', color);
          root.style.setProperty('--accent', color);

          // Reactive Bauhaus palette
          const {c1,c2,c3,bar,ring} = buildPureBauhausPalette(color);
          root.style.setProperty('--shape-1', c1);
          root.style.setProperty('--shape-2', c2);
          root.style.setProperty('--shape-3', c3);
          root.style.setProperty('--shape-4', bar);
          root.style.setProperty('--shape-ring', ring);

          // Adjust text contrast for readability on bright backgrounds
          const lightBg = yiqIsLight(color);
          const text = lightBg ? '#0e0e0e' : '#f7f7f7';
          const textMuted = lightBg ? 'rgba(0,0,0,.72)' : 'rgba(247,247,247,.82)';
          root.style.setProperty('--text', text);
          root.style.setProperty('--text-muted', textMuted);
          // Cursor ring subtle tint
          const ringAlpha = lightBg ? 0.22 : 0.35;
          const {r,g,b} = hexToRgb(color || '#1C7ED6');
          root.style.setProperty('--ring', `0 0 0 3px rgba(${r},${g},${b},${ringAlpha})`);
          
        }

        /* Simple entrance on sections (optional) */
        if (!prefersReduced && 'gsap' in window && window.gsap){
          try{
            if ('ScrollTrigger' in window && window.ScrollTrigger) gsap.registerPlugin(ScrollTrigger);
            const sections = document.querySelectorAll('main section');
            sections.forEach((sec)=>{
              gsap.fromTo(sec,{y:12,opacity:0},{ y:0, opacity:1, duration:0.7, ease:'power2.out', scrollTrigger: ('ScrollTrigger' in window && window.ScrollTrigger) ? { trigger:sec, start:'top 80%', end:'bottom 20%', toggleActions:'play none none reverse' } : undefined });
            });
          }catch(e){ console.warn('GSAP effect skipped:', e); }
        }

        /* Cursor */
        const cursor = document.getElementById('custom-cursor');
        const isTouch = ('ontouchstart' in window) || navigator.maxTouchPoints>0;
        if (isTouch || prefersReduced){ if (cursor) cursor.style.display='none'; }
        else if (cursor){
          document.addEventListener('mousemove',e=>{cursor.style.left=e.clientX+'px';cursor.style.top=e.clientY+'px'});
          document.querySelectorAll('a,button,.case,.card').forEach(el=>{
            el.addEventListener('mouseenter',()=>cursor.classList.add('active'));
            el.addEventListener('mouseleave',()=>cursor.classList.remove('active'));
          });
        }

        /* Menus */
        const radialWrap = document.getElementById('radial-menu-wrap');
        const menu   = document.getElementById('radial-menu');
        const ring   = menu ? menu.querySelector('.rm-circle') : null;
        const fab    = document.getElementById('radial-fab');

        const css = (name, fallback) => getComputedStyle(document.documentElement).getPropertyValue(name).trim() || fallback;
        const items = [
          { label:'Home',       href:'#home',       color: css('--bau-blue','#1C7ED6') },
          { label:'About',      href:'#about',      color: css('--bau-red','#E94F37') },
          { label:'Skills',     href:'#skills',     color: css('--bau-yellow','#F6C90E') },
          { label:'Experience', href:'#experience', color: css('--bau-blue','#1C7ED6') },
          { label:'Cases',      href:'#cases',      color: css('--bau-red','#E94F37') },
          { label:'Contact',    href:'#contact',    color: css('--bau-yellow','#F6C90E') }
        ];

        // Build radial links (only if menu exists)
        const linkMap = new Map();
        if (menu){
          items.forEach((obj, idx)=>{
            const a = document.createElement('a');
            a.className = 'rm-link'; a.textContent = obj.label; a.href = obj.href; a.setAttribute('data-color', obj.color); a.setAttribute('role','link'); a.dataset.idx = String(idx);
            const hover = document.createElement('span'); hover.className = 'rm-hover';
            menu.appendChild(a); menu.appendChild(hover);
            obj.el = a; obj.hover = hover; linkMap.set(a, obj);

            a.addEventListener('mouseover', linkOver);
            a.addEventListener('mouseout', linkOut);
            a.addEventListener('focus', linkOver);
            a.addEventListener('blur', linkOut);
            a.addEventListener('click', (e)=>{
              const id = a.getAttribute('href');
              if (id && id.startsWith('#')){
                const target = document.querySelector(id);
                if (target){
                  e.preventDefault();
                  target.scrollIntoView({behavior:'smooth', block:'start'});
                  setActive(obj.el); setActiveMini(miniMap.get(obj));
                  applyTheme(obj.color); // theme follows selection
                  if (id !== '#home') showRadial(false);
                  history.replaceState(null,'', id);
                }
              }
            });
          });
        }

        function compute(){
          if (!menu || !ring) return; // safe guard
          const vw = Math.max(document.documentElement.clientWidth || 0, window.innerWidth || 0);
          const isMobile = vw <= 820;
          const winH = Math.max(560, Math.min(window.innerHeight || 700, 1400));
          const radius     = Math.min(isMobile ? 150 : 230, Math.max(120, Math.round(winH * 0.30)));
          const borderSize = Math.max(6, Math.round(radius * 0.06));
          const fontSize   = Math.max(14, Math.round(radius * 0.12));
          const linkSize   = Math.max(28, Math.round(radius * 0.25));
          const spreadDeg  = isMobile ? 180 : 330;
          const startDeg   = isMobile ? (-90 - spreadDeg/2) : (-spreadDeg/2);
          const increment  = spreadDeg / (items.length - 1);

          menu.style.width  = (radius*2) + 'px';
          menu.style.height = (radius*2) + 'px';
          ring.style.width       = (radius*2) + 'px';
          ring.style.height      = (radius*2) + 'px';
          ring.style.setProperty('--rm-thickness', borderSize + 'px');

          const rLabel = radius - (borderSize + Math.max(10, linkSize*0.15));

          items.forEach((obj, i)=>{
            if (!obj.el || !obj.hover) return;
            const a = obj.el, hover = obj.hover; const deg = startDeg + (i*increment);
            const baseT = `translate(-50%,-50%) rotate(${deg}deg) translate(${rLabel}px, 0) rotate(${-deg}deg)`;
            setTransition(a, 'transform .18s ease, color .2s ease');
            a.style.fontSize   = fontSize + 'px'; a.style.height = linkSize + 'px'; a.style.lineHeight = linkSize + 'px';
            setTransform(a, baseT); obj.baseTransform = baseT;

            hover.style.height = linkSize + 'px'; hover.style.borderRight = borderSize + 'px solid var(--accent)';
            const hoverT = `translate(-50%,-50%) rotate(${deg}deg)`; setTransition(hover, 'transform .18s ease, opacity .2s ease'); setTransform(hover, hoverT); obj.hoverTransform = hoverT;
          });
        }

        function linkOver(e){
          const a = e.currentTarget; const obj = linkMap.get(a); if (!obj) return;
          const blue = css('--bau-blue','#1C7ED6').toLowerCase();
          const blueLight = css('--bau-blue-light','#4da3f0');
          const color = (a.dataset.color || '#1C7ED6').toLowerCase();
          const hoverColor = (color === blue) ? blueLight : (a.dataset.color || '#1C7ED6');
          setTransform(a, (obj.baseTransform || '') + ' translateX(10px)');
          if (obj.hover) obj.hover.style.opacity = 1;
          if (obj.hover) obj.hover.style.borderRightColor = hoverColor; // why: lighten only blue items
          if (ring) ring.style.transform = 'rotate(20deg)';
        }
        function linkOut(e){
          const a = e.currentTarget; const obj = linkMap.get(a); if (!obj) return;
          setTransform(a, obj.baseTransform || ''); if (obj.hover) obj.hover.style.opacity = 0;
          if (ring) ring.style.transform = 'rotate(0deg)';
        }
        function setActive(el){ items.forEach(i=>i.el && i.el.removeAttribute('aria-current')); if (el) el.setAttribute('aria-current','page'); }

        function setCollapsed(val){ if (menu) menu.dataset.collapsed = String(val); if (fab) fab.setAttribute('aria-expanded', String(!val)); if (fab) fab.textContent = val ? '☰' : '×'; }
        let collapsed = false; setCollapsed(collapsed); if (fab) fab.addEventListener('click', ()=>{collapsed = !collapsed; setCollapsed(collapsed)});

        // Mini header nav
        const siteNav = document.getElementById('site-nav');
        const miniMap = new Map();
        if (siteNav){
          items.forEach((obj)=>{
            const a = document.createElement('a'); a.href = obj.href; a.textContent = obj.label; a.setAttribute('data-color', obj.color);
            a.addEventListener('click',(e)=>{
              const id = a.getAttribute('href'); if (id && id.startsWith('#')){ const target = document.querySelector(id); if (target){ e.preventDefault(); target.scrollIntoView({behavior:'smooth', block:'start'}); setActiveMini(a); applyTheme(obj.color); history.replaceState(null,'', id); } } });
            siteNav.appendChild(a); obj.miniEl = a; miniMap.set(obj, a);
          });
        }
        function setActiveMini(el){ if (!siteNav) return; siteNav.querySelectorAll('a').forEach(n=>n.removeAttribute('aria-current')); if (el) el.setAttribute('aria-current','page'); }

        // IO for sections (also drives overlay fade)
        const sections = document.querySelectorAll('main section[id]');
        if ('IntersectionObserver' in window){
          const io = new IntersectionObserver(entries=>{
            entries.forEach(entry=>{
              if (entry.isIntersecting){
                const id  = '#'+entry.target.id; const match = items.find(i => i.href === id);
                entry.target.setAttribute('data-active','true');
                if (match){ setActive(match.el); setActiveMini(match.miniEl); applyTheme(match.color); }
              } else {
                entry.target.removeAttribute('data-active');
              }
            });
            const nearTop = window.scrollY < 40; document.body.classList.toggle('shrink', !nearTop);
          }, {root:null, threshold:0.55});
          sections.forEach(sec=>io.observe(sec));
        } else {
          sections.forEach(sec=>sec.setAttribute('data-active','true'));
          const first = sections[0];
          if (first){ const c = first.dataset.color || css('--bau-blue','#1C7ED6'); applyTheme(c); }
        }

        // Toggle radial vs mini
        const home = document.getElementById('home');
        function showRadial(visible){ if (radialWrap) radialWrap.dataset.visible = String(visible); document.body.classList.toggle('show-mini-nav', !visible); }
        if ('IntersectionObserver' in window && home){
          const ioHome = new IntersectionObserver(([entry])=>{ if (!entry) return; const visible = entry.isIntersecting && entry.intersectionRatio >= 0.6; showRadial(visible); }, {threshold:[0,0.6,1]});
          ioHome.observe(home);
        } else {
          showRadial(window.scrollY < 80);
        }

        // init
        compute();
        let resizeRaf = 0;
        window.addEventListener('resize', ()=>{ cancelAnimationFrame(resizeRaf); resizeRaf = requestAnimationFrame(compute); }, {passive:true});
        const startHash = location.hash && items.find(i=>i.href === location.hash);
        const startItem = startHash || items.find(i => i.href === '#home');
        if (startItem){ setActive(startItem.el); setActiveMini(startItem.miniEl); applyTheme(startItem.color); }

        window.addEventListener('hashchange', ()=>{
          const match = items.find(i=>i.href === location.hash);
          if (match){
            const target = document.querySelector(match.href);
            if (target) target.scrollIntoView({behavior:'smooth', block:'start'});
            setActive(match.el); setActiveMini(match.miniEl); applyTheme(match.color);
            showRadial(match.href === '#home');
          }
        });

        // ------------------------------
        // Self-tests (non-invasive)
        // ------------------------------
        (function runSelfTests(){
          const results = [];
          function ok(name, pass, note=''){ const s = `${pass?'PASS':'FAIL'}: ${name}${note?` — ${note}`:''}`; results.push(s); return pass; }

          try{ ok('DOM: radial menu exists', !!menu); }catch(e){ ok('DOM: radial menu exists', false, e.message); }
          try{ ok('DOM: ring exists', !!ring); }catch(e){ ok('DOM: ring exists', false, e.message); }
          try{ compute(); ok('compute() callable', true); }catch(e){ ok('compute() callable', false, e.message); }
          try{ const ioAvail = 'IntersectionObserver' in window; ok('Feature: IntersectionObserver', ioAvail); }catch(e){ ok('Feature: IntersectionObserver', false, e.message); }
          try{ const hasGsap = !!(window.gsap); ok('Feature: GSAP present or skipped', true, hasGsap ? 'present' : 'skipped'); }catch(e){ ok('Feature: GSAP present', false, e.message); }

          // Palette tests: shape vars exist and contrast with page-bg
          try{
            const cs = (v)=>getComputedStyle(document.documentElement).getPropertyValue(v).trim();
            const bg = cs('--page-bg');
            const s1 = cs('--shape-1'), s2 = cs('--shape-2'), s3 = cs('--shape-3'), sr = cs('--shape-ring');
            const good = (c)=>{ if(!c||!bg) return false; const d=Math.abs((c&&c[0]==='#')? ( (function(){const {r,g,b}=hexToRgb(c); return (r*299+g*587+b*114)/1000;})() ):0 - (function(){const {r,g,b}=hexToRgb(bg); return (r*299+g*587+b*114)/1000;})()); return d>=55; };
            ok('Palette: shape-1 contrasts', good(s1));
            ok('Palette: shape-2 contrasts', good(s2));
            ok('Palette: shape-3 contrasts', good(s3));
            ok('Palette: ring contrasts',    good(sr));
          }catch(e){ ok('Palette: computed', false, e.message); }

          if (results.some(r=>r.startsWith('FAIL'))){
            setBugBanner(results.join(' | '));
          } else {
            console.debug('[Self-tests]', results.join(' | '));
          }
        })();
      }catch(err){
        console.error('Boot error:', err);
        setBugBanner('Boot error: '+ (err && err.message ? err.message : String(err)));
      }
    });
  </script>
</body>
</html>
